{"ast":null,"code":"import { takeLatest, all, call, put, select } from 'redux-saga/effects';\nimport axios from 'axios';\nimport USER_ACTIONS_TYPES from '../user/user.types';\nimport { setCurrentUser, signOutSuccess } from '../user/user.action';\nimport { selectCurrentUser } from './user.selector';\nimport { selectCartItem, selectTotalPrice } from '../cart/cart.selector';\nexport function fetchUserToServer(data, type) {\n  return axios(`http://localhost:2222/user/${type}`, {\n    method: \"post\",\n    data: data\n  });\n}\nexport function fetchBookingToServer(data) {\n  let token = \"Bear \" + JSON.parse(localStorage.getItem(\"login\"));\n  return axios(`http://localhost:2222/booking`, {\n    method: \"POST\",\n    headers: {\n      'Authorization': token\n    },\n    data: data\n  });\n}\nexport function* createBooking({\n  payload\n}) {\n  const currentUser = yield select(selectCurrentUser);\n  const cartItem = yield select(selectCartItem);\n  const totalMoney = yield select(selectTotalPrice);\n  const data = Object.assign({}, {\n    cart: cartItem,\n    totalMoney,\n    address: payload,\n    idUser: currentUser._id\n  });\n  const response = yield call(fetchBookingToServer, data);\n}\nexport function* signUp({\n  payload\n}) {\n  const {\n    data: {\n      data: {\n        user\n      }\n    }\n  } = yield call(fetchUserToServer, payload, \"register\");\n  yield put(setCurrentUser(user));\n}\nexport function* signIn({\n  payload\n}) {\n  const {\n    data: {\n      data: {\n        user\n      }\n    }\n  } = yield call(fetchUserToServer, payload, \"signIn\");\n  yield put(setCurrentUser(user));\n}\nexport function* signOut() {\n  localStorage.removeItem(\"login\");\n  yield put(signOutSuccess());\n}\nexport function* onSignOutStart() {\n  yield takeLatest(USER_ACTIONS_TYPES.SIGN_OUT_START, signOut);\n}\nexport function* onSignUpStart() {\n  yield takeLatest(USER_ACTIONS_TYPES.SIGN_UP_START, signUp);\n}\nexport function* onSignInStart() {\n  yield takeLatest(USER_ACTIONS_TYPES.SIGN_IN_START, signIn);\n}\nexport function* onCreateBookingStart() {\n  yield takeLatest(USER_ACTIONS_TYPES.CREATE_BOOKING_START, createBooking);\n}\nexport function* userSagas() {\n  yield all([call(onSignUpStart), call(onSignInStart), call(onSignOutStart), call(onCreateBookingStart)]);\n}","map":{"version":3,"sources":["/Users/thuongle/Desktop/e-ecommerce/client/src/redux/user/user.sagas.js"],"names":["takeLatest","all","call","put","select","axios","USER_ACTIONS_TYPES","setCurrentUser","signOutSuccess","selectCurrentUser","selectCartItem","selectTotalPrice","fetchUserToServer","data","type","method","fetchBookingToServer","token","JSON","parse","localStorage","getItem","headers","createBooking","payload","currentUser","cartItem","totalMoney","Object","assign","cart","address","idUser","_id","response","signUp","user","signIn","signOut","removeItem","onSignOutStart","SIGN_OUT_START","onSignUpStart","SIGN_UP_START","onSignInStart","SIGN_IN_START","onCreateBookingStart","CREATE_BOOKING_START","userSagas"],"mappings":"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","sourcesContent":["import {takeLatest, all, call,put , select} from 'redux-saga/effects';\nimport axios from 'axios';\nimport USER_ACTIONS_TYPES from '../user/user.types';\nimport {setCurrentUser,signOutSuccess} from '../user/user.action';\nimport {selectCurrentUser} from './user.selector';\nimport { selectCartItem, selectTotalPrice } from '../cart/cart.selector';\n\nexport function fetchUserToServer (data,type) {\n    return axios(`http://localhost:2222/user/${type}`,{\n        method: \"post\",\n        data: data\n    })\n}\n\nexport function fetchBookingToServer (data) {\n    let token = \"Bear \" + JSON.parse(localStorage.getItem(\"login\"));\n    return axios(`http://localhost:2222/booking`, {\n        method : \"POST\",\n        headers : {\n            'Authorization': token\n        }, \n        data : data\n    })\n}\n\n\nexport function* createBooking({payload}) {\n    const currentUser = yield select(selectCurrentUser);\n    const cartItem = yield select(selectCartItem);\n    const totalMoney = yield select(selectTotalPrice);\n    const data = Object.assign({} , {\n        cart:cartItem,\n        totalMoney,\n        address: payload,\n        idUser : currentUser._id\n    })\n    const response = yield call(fetchBookingToServer,data)\n    \n}\n\nexport function * signUp({payload}) {\n   const {data : {data : {user}}} = yield call(fetchUserToServer,payload,\"register\");\n   yield put(setCurrentUser(user))\n}\n\nexport function* signIn({payload}) {\n    const {data : {data : {user}}} = yield call(fetchUserToServer,payload, \"signIn\");\n    yield put(setCurrentUser(user));\n}\n\nexport function* signOut() {\n    localStorage.removeItem(\"login\")\n    yield put(signOutSuccess())\n}\n\nexport function* onSignOutStart() {\n    yield takeLatest(USER_ACTIONS_TYPES.SIGN_OUT_START, signOut)\n}\n\n\nexport function* onSignUpStart() {\n    yield takeLatest(USER_ACTIONS_TYPES.SIGN_UP_START,signUp);\n}\nexport function* onSignInStart() {\n    yield takeLatest(USER_ACTIONS_TYPES.SIGN_IN_START,signIn)\n}\n\nexport function* onCreateBookingStart() {\n    yield takeLatest(USER_ACTIONS_TYPES.CREATE_BOOKING_START, createBooking)\n}\n\nexport function* userSagas() {\n    yield all([\n        call(onSignUpStart),\n        call(onSignInStart),\n        call(onSignOutStart),\n        call(onCreateBookingStart)\n    ])\n}"]},"metadata":{},"sourceType":"module"}